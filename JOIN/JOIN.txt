
-- TWO TABLE JOIN WITHOUT JOIN METHODS

SELECT FIRST_NAME , DEPARTMENT_NAME 
FROM EMPLOYEES,DEPARTMENTS
WHERE EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;


-- TWO TABLE JOIN METHODES USE

SELECT FIRST_NAME , DEPARTMENT_NAME
FROM EMPLOYEES 
JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;


-- INNER JOIN , RIGHT JOIN ,LEFT JOIN ,CROSS JOIN 

SELECT FIRST_NAME ,DEPARTMENT_NAME
FROM EMPLOYEES
LEFT JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;


SELECT FIRST_NAME ,DEPARTMENT_NAME
FROM EMPLOYEES
RIGHT JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;

SELECT FIRST_NAME ,DEPARTMENT_NAME
FROM EMPLOYEES
CROSS JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;


-- EXAMPLE WITH ADVANCED QUERY


-- SELF JOIN 
SELECT M.FIRST_NAME , E.FIRST_NAME
FROM EMPLOYEES AS E
JOIN EMPLOYEES AS M
ON E.EMPLOYEE_ID = M.MANAGER_ID;


SELECT DEPARTMENTS.DEPARTMENT_NAME
FROM DEPARTMENTS
	LEFT JOIN EMPLOYEES 
    ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID
    WHERE EMPLOYEES.DEPARTMENT_ID IS NULL;



SELECT 
EMPLOYEES.FIRST_NAME, EMPLOYEES.SALARY,DEPARTMENTS.DEPARTMENT_NAME,
(SELECT AVG(SALARY) FROM EMPLOYEES WHERE DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID) - EMPLOYEES.SALARY
FROM EMPLOYEES
JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;





SELECT DEPARTMENT_NAME,MAX(SALARY),AVG(SALARY)
FROM EMPLOYEES
JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID
GROUP BY DEPARTMENT_NAME HAVING MAX(SALARY) < 5000;






